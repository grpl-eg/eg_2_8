define("jquery-noconflict",["jquery"],function(e){return e.noConflict(!0)}),define("od_config",["moment"],function(e){var t;return e.lang("en",{longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM Do YYYY",LLL:"MMMM Do YYYY LT",LLLL:"dddd, MMMM Do YYYY LT"}}),t={"long name one":"name1","long name two":"name2"},{credentials:"",accountID:4321,websiteID:321,authorizationname:function(e){return t[e]},password_required:"false",baseURL:"http://overdrive.grpl.org/ContentDetails.htm",productbaseURLs:["overdrive.grpl.org"],blacklisted:function(e,t){var n,r,i,s;e==null&&(e=window.location.hostname),t==null&&(t=["abc","xyz"]);if(!(e=(s=e.match(/^(.+?)\./))!=null?s[1]:void 0))return;if(!((t!=null?t.length:void 0)>0))return;for(r=0,i=t.length;r<i;r++){n=t[r];if(n===e)return!0}}}});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("od_session",["json","lodash","od_config"],function(e,t,n){var r,i,s,o,u,a,f;return f=function(){function n(){}return n.prototype.update=function(e){var t;if(!e)return;t=this,__extends(t,e)},n.prototype.store=function(){return e.stringify(this,function(e,t){return e==="prototype"?void 0:t},"  ")},n.prototype.retrieve=function(n){return n=function(){if(t.isString(n))try{return e.parse(n)}catch(r){return void 0}}()},n.prototype.proxy=function(e){var t;if(!e)return;return t=e,t=t.replace("https://","//"),t=t.replace("http://","//"),t=t.replace("//oauth-patron.overdrive.com","/od/oauth-patron"),t=t.replace("//oauth.overdrive.com","/od/oauth"),t=t.replace("//patron.api.overdrive.com","/od/api-patron"),t=t.replace("//api.overdrive.com","/od/api"),t=t.replace("//images.contentreserve.com","/od/images"),t=t.replace("//fulfill.contentreserve.com","/od/fulfill"),t},n.prototype.proxies=function(e){var t,n,r;for(n in e){r=e[n];if(t=r.href)r.href=this.proxy(t)}return e},n}(),o=function(e){function t(e){this.update(e)}return __extends(t,e),t["default"]={barcode:"",email_address:"",home_library:""},t.prototype.update=function(e){return t.__super__.update.call(this,e||t["default"])},t}(f),r=function(e){function t(e){this.update(e)}return __extends(t,e),t["default"]={username:"",password:"xxxx"},t.prototype.update=function(e){return t.__super__.update.call(this,e||t["default"])},t.prototype.un=function(){return this.barcode||this.username},t.prototype.pw=function(e){return e?this.password:"xxxx"},t}(f),a=function(e){function t(e){this.update(e)}return __extends(t,e),t["default"]={access_token:void 0,expires_in:void 0,scope:void 0,token_type:void 0},t.prototype.update=function(e){return t.__super__.update.call(this,e||t["default"])},t.prototype.is_patron_access=function(){return/patron/i.test(this.scope)},t}(f),s=function(e){function t(e,t){this.update(e),e&&this.calibrate(t);return}return __extends(t,e),t["default"]={token:{href:"//oauth.overdrive.com/token"},libraries:{href:"//api.overdrive.com/v1/libraries/"+n.accountID},patrontoken:{href:"//oauth-patron.overdrive.com/patrontoken"},patrons:{href:"//patron.api.overdrive.com/v1/patrons/me"},holds:{href:""},checkouts:{href:""},products:"",advantageAccounts:"",search:"",availability:""},t.prototype.update=function(e){e==null&&t.__super__.update.call(this,this.proxies(t["default"])),(e!=null?e.links:void 0)&&t.__super__.update.call(this,this.proxies(e.links)),(e!=null?e.linkTemplates:void 0)&&t.__super__.update.call(this,this.proxies(e.linkTemplates))},t.prototype.calibrate=function(e){return e||(this.search=this.availability=""),this},t}(f),i=function(e){function t(e){this.update(e)}return __extends(t,e),t.prototype.update=function(e){if(e!=null?e.formats:void 0)return t.__super__.update.call(this,this.to_object(e.formats,"id","name"))},t.prototype.to_object=function(e,t,n){var r,i,s,o;r={};if((e!=null?e.length:void 0)>0)for(s=0,o=e.length;s<o;s++)i=e[s],r[i[t]]=i[n];return r},t}(f),u=function(e){function t(e,t){e=this.retrieve(e),this.prefs=new o(e!=null?e.prefs:void 0),this.creds=new r(e!=null?e.creds:void 0),this.token=new a(e!=null?e.token:void 0),this.links=new s(e,t),this.labels=new i(e);return}return __extends(t,e),t}(f),u});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("od_data",["lodash","moment"],function(e,t){var n,r,i,s,o,u;return u=function(){function e(e){var t;if(!e)return;t=this,__extends(t,e);return}return e.prototype.momentize=function(e,n){switch(arguments.length){case 1:return e?t(e.replace(/Z$/,"-0400")):t();case 2:return e?t().add(e,n):t();default:return t()}},e.prototype.proxy=function(e){var t;if(!e)return;return t=e,t=t.replace("https://","//"),t=t.replace("http://","//"),t=t.replace("//oauth-patron.overdrive.com","/od/oauth-patron"),t=t.replace("//oauth.overdrive.com","/od/oauth"),t=t.replace("//patron.api.overdrive.com","/od/api-patron"),t=t.replace("//api.overdrive.com","/od/api"),t=t.replace("//images.contentreserve.com","/od/images"),t=t.replace("//fulfill.contentreserve.com","/od/fulfill"),t},e.prototype.proxies=function(e){var t,n,r;for(n in e){r=e[n];if(t=r.href)r.href=this.proxy(t)}return e},e}(),o=function(e){function t(e){var n;t.__super__.constructor.call(this,e),this.id=this.id.toUpperCase(),this.author=function(){var e,t,r,i;r=this.creators,i=[];for(e=0,t=r.length;e<t;e++)n=r[e],n.role==="Author"&&i.push(n.name);return i}.call(this)[0]||"",this.proxies(this.images);return}return __extends(t,e),t}(u),n=function(t){function n(e,t){var r;return n.__super__.constructor.call(this,e),this.zero(),((r=this.actions)!=null?r.hold:void 0)&&this.hold(t),this.actions!=null&&this.proxies(this.actions),this.action_formats(),this}return __extends(n,t),n.prototype.zero=function(){return this.copiesOwned||(this.copiesOwned=0),this.copiesAvailable||(this.copiesAvailable=0),this.numberOfHolds||(this.numberOfHolds=0),this},n.prototype.hold=function(t){return e.where(this.actions.hold.fields,{name:"reserveId"})[0].value=this.id,t&&(e.where(this.actions.hold.fields,{name:"emailAddress"})[0].value=t),this},n.prototype.action_formats=function(){var e,t,n,r,i,s,o;n=(s=this.actions)!=null?(o=s.checkout)!=null?o.fields:void 0:void 0;if((n!=null?n.length:void 0)>0){for(r=0,i=n.length;r<i;r++){t=n[r];if(t.name==="formatType")break}return t.options.length>0?(this.formats=function(){var n,r,i,s;i=t.options,s=[];for(n=0,r=i.length;n<r;n++)e=i[n],s.push({id:e,name:""});return s}(),this):this}return this},n}(u),i=function(t){function n(e){n.__super__.constructor.call(this,e),this.add().remove().proxy_urls().moments().count().sort();return}return __extends(n,t),n.prototype.add=function(){return this.holds===void 0&&(this.holds=[]),this},n.prototype.remove=function(){var e,t,n,r;r=this.holds;for(t=0,n=r.length;t<n;t++)e=r[t],e.holdSuspension||delete e.actions.releaseSuspension;return this},n.prototype.proxy_urls=function(){var e,t,n,r,i;i=this.holds;for(e=n=0,r=i.length;n<r;e=++n)t=i[e],this.proxies(t.actions);return this},n.prototype.moments=function(){var e,t,n,r;r=this.holds;for(t=0,n=r.length;t<n;t++)e=r[t],e.holdPlacedDate=this.momentize(e.holdPlacedDate),e.holdExpires=this.momentize(e.holdExpires),e.holdSuspension&&(e.holdSuspension.numberOfDays=this.momentize(e.holdSuspension.numberOfDays,"days"));return this},n.prototype.count=function(){return this.ready=e.countBy(this.holds,function(e){return e.actions.checkout?"forCheckout":"other"}),this.ready.forCheckout||(this.ready.forCheckout=0),this},n.prototype.sort=function(){return this.holds=e(this.holds).sortBy(["holdListPosition","holdPlacedDate"]).sortBy(function(e){return e.actions.checkout}).value(),this},n}(u),r=function(t){function n(e){n.__super__.constructor.call(this,e),this.add().proxy_urls().moments().sort();return}return __extends(n,t),n.prototype.add=function(){return this.checkouts===void 0&&(this.checkouts=[]),this},n.prototype.proxy_urls=function(){var e,t,n,r,i,s,o,u;o=this.checkouts;for(n=0,i=o.length;n<i;n++){e=o[n],this.proxies(e.actions),u=e.formats;for(r=0,s=u.length;r<s;r++)t=u[r],this.proxies(t.linkTemplates)}return this},n.prototype.moments=function(){var e,t,n,r;r=this.checkouts;for(t=0,n=r.length;t<n;t++)e=r[t],e.expires=this.momentize(e.expires);return this},n.prototype.sort=function(){return this.checkouts=e.sortBy(this.checkouts,"expires"),this},n}(u),s=function(){function e(e,t){return{nHolds:e.totalItems,nHoldsReady:e.ready.forCheckout,nCheckouts:t.totalItems,nCheckoutsReady:t.totalCheckouts,ofHolds:e.holds,ofCheckouts:t.checkouts,byID:function(e,t){var n,r,i,s,o,u,a;n={};for(r=s=0,u=e.length;s<u;r=++s)i=e[r],i.type="hold",n[i.reserveId]=i;for(r=o=0,a=t.length;o<a;r=++o)i=t[r],i.type="checkout",n[i.reserveId]=i;return n}(e.holds,t.checkouts)}}return e}(),{Metadata:o,Availability:n,Holds:i,Checkouts:r,Interests:s}});var __slice=[].slice;define("od_api",["jquery-noconflict","lodash","json","cookies","moment","od_config","od_session","od_data"],function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m;return c=function(){var e,t,n;try{for(t=0,n=arguments.length;t<n;t++)e=arguments[t],dump(""+e+"\n")}catch(r){console.log(arguments)}},a=e({}),h=function(e,t,n){return c(""+t+" "+e.status+" "+n),a.trigger("od.fail",arguments)},f=["od.clientaccess","od.libraryinfo","od.metadata","od.availability","od.patronaccess","od.patroninfo","od.holds","od.checkouts","od.interests","od.action","od.hold.update","od.hold.delete","od.checkout.update","od.checkout.delete","od.prefs","od.login","od.logout","od.error"],l=e({}).on(f.join(" "),function(){var e,t,n;e=arguments[0],t=arguments[1],n=3<=arguments.length?__slice.call(arguments,2):[]}),v=new o(window.name,Boolean(r("eg_loggedin")||window.IAMXUL)),e(window).on("unload",function(){return window.name=v.store()}),m=function(t,n){return e.ajax(e.extend({},{headers:{Authorization:"Basic "+s.credentials},url:t,type:"POST",data:n}))},d=function(t){var n;return n={},e.each(t,function(){var e,t;return t=this.value||"",(e=n[this.name])!==void 0?(e.push||(n[this.name]=[e]),n[this.name].push(t)):n[this.name]=t}),n},e.fn.extend({_serializeObject:function(){return d(this.serializeArray())},_serializeX:function(t){switch(t){case"j":return n.stringify(this._serializeX("o"));case"k":return n.stringify(this._serializeX("a"));case"p":return e.param(this._serializeX("a"));case"s":return this.serialize();case"o":return d(this._serializeX("a"));case"a":return this.serializeArray();default:return this}}}),p={$:l.on({"od.prefs":function(e,t){return v.prefs.update(t)},"od.logout":function(e,t){if(t==="eg"&&v.token.is_patron_access())return v=new o}}),log:c,labels:function(e){return v.labels[e]||e},api:function(t,r,s,o){var a,f,l,c;if(r==="post"){c=s.fields;for(f=0,l=c.length;f<l;f++)a=c[f],a.name==="numberOfDays"&&(a.value=1+i(a.value).diff(i().toArray().slice(0,3),"days"))}return e.ajax(e.extend({},{headers:{Authorization:""+v.token.token_type+" "+v.token.access_token},url:t,type:r,contentType:"application/json; charset=utf-8",data:n.stringify(s),beforeSend:o})).done(function(){var e,n;r==="post"&&(/\/holds|\/suspension/.test(t)&&(n=new u.Holds({holds:[arguments[0]]}),p.$.triggerHandler("od.hold.update",n)),/\/checkouts/.test(t)&&(n=new u.Checkouts({checkouts:[arguments[0]]}),p.$.triggerHandler("od.checkout.update",n)));if(r==="delete"){if(e=t.match(/\/holds\/(.+)\/suspension$/))return;(e=t.match(/\/holds\/(.+)$/))&&p.$.triggerHandler("od.hold.delete",e[1]);if(e=t.match(/\/checkouts\/(.+)$/))return p.$.triggerHandler("od.checkout.delete",e[1])}}).fail(function(){return p.$.triggerHandler("od.error",[t,arguments[0]])})},apiDiscAccess:function(){var e;return e=function(e){return v.token.update(e),p.$.triggerHandler("od.clientaccess",e),e},m(v.links.token.href,{grant_type:"client_credentials"}).then(e,h)},apiLibraryInfo:function(){var e,t,n;return e=function(){return p.api(v.links.libraries.href)},t=function(e){return v.links.update(e),v.labels.update(e),p.$.triggerHandler("od.libraryinfo",e),e},n=function(n){if(n.status===401)return v.token.is_patron_access()?p.$.triggerHandler("od.logout","od"):p.apiDiscAccess().then(e,h).then(t)},e().then(t,n)},login:function(t){var n,r;if(t){v.creds.update(t),v.token.update(),p.$.triggerHandler("od.login");return}return v.token.is_patron_access()?e.Deferred().resolve().promise():(n=function(e){var t,n,r,i;return i=function(t){var n,r;return n=new RegExp(""+t+"<\\/td>\\s+<td.+>(.*?)<\\/td>","i"),((r=e.match(n))!=null?r[1]:void 0)||""},v.prefs.update({barcode:i("barcode"),email_address:i("email address"),home_library:i("home library")}),r=v.prefs.barcode||v.creds.un(),t=v.creds.pw(s.password_required),v.creds.update(),n="websiteid:"+s.websiteID+" authorizationname:"+s.authorizationname(v.prefs.home_library),m(v.links.patrontoken.href,{grant_type:"password",username:r,password:t,password_required:s.password_required,scope:n})},r=function(e){return v.token.update(e),p.$.triggerHandler("od.patronaccess",e),e},e.get("/eg/opac/myopac/prefs").then(n).then(r).then(p.apiPatronInfo).fail(c))},apiSearch:function(e){if(!e)return;return p.api(v.links.products.href,get,e)},apiMetadata:function(e){if(!e.id)return;return p.api(""+v.links.products.href+"/"+e.id+"/metadata").then(function(e){return e=new u.Metadata(e),p.$.triggerHandler("od.metadata",e),e}).fail(function(){return p.$.triggerHandler("od.metadata",e)})},apiAvailability:function(e){var t,n,r;if(!e.id)return;return n=(t=(r=v.links.availability)!=null?r.href:void 0)?t.replace("{crId}",e.id):""+v.links.products.href+"/"+e.id+"/availability",p.api(n).then(function(e){return e=new u.Availability(e,v.prefs.email_address),p.$.triggerHandler("od.availability",e),e}).fail(function(){return p.$.triggerHandler("od.availability",e)})},apiPatronInfo:function(){var e;return e=function(e){return v.links.update(e),p.$.triggerHandler("od.patroninfo",e),e},p.api(v.links.patrons.href).then(e,h)},apiHoldsGet:function(e){if(!v.token.is_patron_access())return;return p.api(""+v.links.holds.href+((e!=null?e.productID:void 0)?e.productID:"")).then(function(e){return e=new u.Holds(e),p.$.triggerHandler("od.holds",e),e})},apiCheckoutsGet:function(e){if(!v.token.is_patron_access())return;return p.api(""+v.links.checkouts.href+((e!=null?e.reserveID:void 0)?e.reserveID:"")).then(function(e){return e=new u.Checkouts(e),p.$.triggerHandler("od.checkouts",e),e})},apiInterestsGet:function(){return e.when(p.apiHoldsGet(),p.apiCheckoutsGet()).then(function(e,t){var n;return n=new u.Interests(e,t),p.$.triggerHandler("od.interests",n),n})}},p}),define("od_pages_opac",["jquery-noconflict","lodash","od_api","od_config","jquery-ui"],function(e,t,n,r){return e.fn.extend({_show_formats:function(r){var i;return r?(i=(r!=null?r.length:void 0)>0?e("<ul>").css("padding-left","20px").append(t.map(r,function(t){return e("<li>").append(t.name||n.labels(t.id||t.id))})):e("<span>").css("color","red").text("No available formats"),this.append(i)):this},_productID:function(){var t,n,i,s,o,u,a;n=[],u=r.productbaseURLs;for(s=0,o=u.length;s<o;s++)i=u[s],n.push('a[href*="'+i+'"]');return t=e(n.join(","),this).attr("href"),(a=/ID=(.+)/.exec(t))!=null?a[1]:void 0},_results:function(){var t,n,r,i,s,o;r='<tr name="e_holdings" class="result_table_title_cell">\n	<td colspan="2">\n		<table class="result_holdings_table">\n			<thead>\n				<tr>\n					<th>Available Formats</th>\n					<th>Status</th>\n				</tr>\n			</thead>\n			<tbody>\n				<tr>\n					<td class="formats"></td>\n					<td class="status"></td>\n				</tr>\n			</tbody>\n		</table>\n	</td>\n</tr>',n=[];for(s=0,o=this.length;s<o;s++){i=this[s];if(t=e(i)._productID())e(i).find("abbr.unapi-id[title*='metabib-metarecord']").length>0||(n.push(t),e(i).prop("id",t).find(".results_info_table > tbody").append(r).end()._results_meta()._results_avail())}return n},_results_meta:function(e){var t;return t=arguments.length===0?{value:!1}:"destroy",this.find(".result_holdings_table .formats").progressbar(t)._show_formats(e!=null?e.formats:void 0).end()},_results_avail:function(n){var r,i,s;return i=arguments.length===0?{value:!1}:"destroy",this.find(".result_holdings_table .status").progressbar(i).end(),n?(s=t.template("<span><%= n_avail %> of <%= n_owned %> available, <%= n_holds %> holds</span>"),r=e(s({n_avail:n.copiesAvailable,n_owned:n.copiesOwned,n_holds:n.numberOfHolds})),this.find(".result_holdings_table .status").append(r).end()):this},_record:function(){var t,n;n=this._productID();if(!n)return;return t=e('<div id="copy_hold_counts"><div id="'+n+'">\n	<span id="rdetail_copy_counts">\n		<h2>Available formats</h2>\n		<div class="formats"></div>\n	</span>\n	<span id="rdetail_hold_counts">\n		<h2>Status</h2>\n		<div class="status"></div>\n	</span>\n</div></div>'),t._record_meta()._record_avail(),this.after(t),n},_record_meta:function(e){var t;return t=arguments.length===0?{value:!1}:"destroy",this.find(".formats").progressbar(t)._show_formats(e!=null?e.formats:void 0).end()},_record_avail:function(n){var r,i,s;return i=arguments.length===0?{value:!1}:"destroy",this.find(".status").progressbar(i).end(),n?(s=t.template("<span><%= n_avail %> of <%= n_owned %> available, <%= n_holds %> holds</span>"),r=e(s({n_avail:n.copiesAvailable,n_owned:n.copiesOwned,n_holds:n.numberOfHolds})),this.find(".status").append(r).end()):this},_replace_place_hold_link:function(t,n){var r,i,s,o,u,a,f,l,c,h,p;return t?(r=this.find(".place_hold > a"),s=(a=r.text()).match(/E-book/)||a.match(/E-audiobook/)||"E-item",o=((h=r.prop("title").match(/on (.+)/))!=null?h[1]:void 0)||s,p=function(){switch(n){case"hold":return["Go to<br>E-items On Hold","Go to E-items On Hold","/eg/opac/myopac/holds?e_items"];case"checkout":return["Go to<br>E-items Checked Out","Go to E-items Checked Out","/eg/opac/myopac/circs?e_items"];default:return u=e.param({e_items:1,interested:t.id}),c=t.available?"Check Out":"Place Hold on",l=t.available?"/eg/opac/myopac/circs":"/eg/opac/myopac/holds",[""+c+"<br>"+s,""+c+" "+o,""+l+"?"+u]}}(),a=p[0],f=p[1],i=p[2],r.prop({title:f,href:i}).find("img").prop("alt",f).end().find(".result_place_hold, .place_hold").replaceWith(a).end(),this):this}})}),define("od_action",["jquery-noconflict","lodash","json","od_api","jquery-ui"],function(e,t,n,r){var i,s,o;return function(e){var t;return t=document.createElement("link"),t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}("//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/smoothness/jquery-ui.min.css"),s=function(){var e;return e=window.location.pathname.match(/eg\/opac\/(.+)/),e?e[1].replace(/\/\d+/,""):""},o=function(e){return n.parse(e.responseText).message},e.widget("ui.dialogAction",e.ui.dialog,{options:{draggable:!1,resizable:!0,modal:!0,buttons:[{text:"Yes",click:function(t){t.stopPropagation(),e(this).dialogAction("yes_action")}},{text:"No",click:function(t){t.stopPropagation(),e(this).dialogAction("autoclose")}}]},_create:function(){var t,n,r,i,s,o,u,a,f;return r=(o=this.options._scenario)!=null?o.intent:void 0,s=(u=this.options._action)!=null?u._of:void 0,r&&(i=this.options.buttons,n=r.buttons,i[0].text=(n!=null?n[0]:void 0)||"Yes",i[1].text=(n!=null?n[1]:void 0)||"No"),s&&(this.options.position={of:s,at:"top",my:"top"}),this._super(),t=(a=this.options._scenario.intent)!=null?a.body:void 0,this.set_message("intent",!r,e.isFunction(t)?t((f=this.options._action)!=null?f._name:void 0):void 0),this._on({dialogactionclose:function(){return this._destroy()}})},set_message:function(t,n,r,i){var s;return this._close_button(n),s=this.options._scenario[t],this.element.empty().append(r||(s!=null?s.body:void 0)||e("<div>").progressbar({value:!1})),this.option("title",i||(s!=null?s.title:void 0)||this.options._action._of._etitle()),this},autoclose:function(){var e,t;return this._on({dialogactionclose:((e=this.options._scenario)!=null?(t=e.intent)!=null?t.reroute:void 0:void 0)||function(){}}),this.close(),this},yes_action:function(){var t,n,i,s;return this.option("buttons",[]),i=function(e){return function(){var t,n;return e._on({dialogactionclose:((t=e.options._scenario)!=null?(n=t.done)!=null?n.reroute:void 0:void 0)||function(){}})}}(this),n=function(e){return function(){return i(),e.close()}}(this),t=this.options._action,s=function(e){return function(){return e.set_message("progress",!0)}}(this),r.api(t.href,t.method,{fields:e("form",this.element).serializeArray()},s).then(function(t){return function(r){var i,s,o;return i=(s=t.options._scenario.done)!=null?s.body:void 0,t.set_message("done",!0,e.isFunction(i)?i(r):void 0),window.setTimeout(n,((o=t.options._scenario.done)!=null?o.timeout:void 0)||2e3)}}(this),function(e){return function(t){return e.set_message("fail",!0,o(t))}}(this)).done(i),this},_close_button:function(e){var t;return t=this.element.parent().find(".ui-dialog-titlebar-close"),e?t.show().focus():t.hide(),this}}),i={hold:"Place hold",addSuspension:"Suspend",releaseSuspension:"Activate",removeHold:"Cancel",checkout:"Check out",earlyReturn:"Return title",format:"Select format"},e.fn.extend({_hold:function(t){var n;return n={intent:{body:e("<div>")._action_fields(t.fields),buttons:["Place hold","Cancel"],reroute:function(){return window.history.back()}},done:{body:"Hold was successfully placed. Close this box to be redirected to your holds list.",reroute:function(){return window.location.replace("/eg/opac/myopac/holds?e_items")}},fail:{body:"Hold was not placed. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:n,_action:t})},_removeHold:function(e){var t;return t={intent:{body:"Are you sure you want to cancel this hold?"},done:{body:"Hold was successfully cancelled."},fail:{body:"Hold was not cancelled. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:t,_action:e})},_addSuspension:function(t){var n;return n={intent:{body:e("<div>")._action_fields(t.fields),buttons:["Suspend","Cancel"]},done:{body:"Hold was successfully suspended"},fail:{body:"Hold was not suspended. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:n,_action:t})},_releaseSuspension:function(e){var t;return t={intent:{body:"Are you sure you want this hold to activate again?"},done:{body:"Suspension was successfully released. The page will reload to update your account status.",reroute:function(){return window.location.reload(!0)}},fail:{body:"Suspension was not released. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:t,_action:e})},_checkout:function(t){var n;return n={intent:{body:e("<div>")._action_fields(t.fields),buttons:["Check out","Cancel"],reroute:function(){if(s()==="place_hold")return window.history.back()}},done:{body:"Title was successfully checked out. Close this page to be redirected to your checkouts list.",reroute:function(){return window.location.replace("/eg/opac/myopac/circs?e_items")}},fail:{body:"Title was not checked out. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:n,_action:t})},_format:function(t){var n;return n={intent:{body:e("<div>")._action_fields(t.fields),buttons:["Select format","Cancel"]},done:{body:"Format was successfully selected."},fail:{body:"Format was not selected. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:n,_action:t})},_earlyReturn:function(e){var t;return t={intent:{body:"Are you sure you want to return this title before it expires?"},done:{body:"Title was successfully returned."},fail:{body:"Title was not returned. There may have been a network or server problem. Please try again."}},this.dialogAction({_scenario:t,_action:e})},_downloadLink:function(t){var n;return n={intent:{body:function(e){return e==="ebook-overdrive"?"Download content to read in the browser?":"Download content for an e-book reader?"}},done:{body:function(t){return e("<div>Content is ready.</div>\n<a href="+t.links.contentlink.href+">Right-click to download in a new tab or window.</a>\n<div>The link is valid for the next 60 seconds.</div>")},timeout:59e3},fail:{body:"could not download"}},this.dialogAction({_scenario:n,_action:t})},_actions:function(n,r,s){var o,u,a,f,l;return l=t.template('<div>\n	<a href="<%= href %>" class="opac-button <%= action_name %>" style="margin-top: 0px; margin-bottom: 0px"><%= label %></a>\n</div>'),u=this.closest("tr"),o=function(){var t;t=[];for(f in n)a=n[f],s==null||f!=="addSuspension"?(e.extend(a,{_of:u,_name:f,_id:r}),t.push(e(l({href:a.href,action_name:f,label:(i!=null?i[f]:void 0)||f})).on("click",a,function(t){return t.preventDefault(),e("<div>")["_"+t.data._name](t.data),!1}))):t.push(void 0);return t}(),this.empty().append(o)},_action_fields:function(n){return e("<form>")._action_field_hidden(t.where(n,{name:"reserveId"})[0])._action_field_email(t.where(n,{name:"emailAddress"})[0])._action_field_radio(t.where(n,{name:"formatType"})[0])._action_field_suspend(t.where(n,{name:"suspensionType"})[0])._action_field_date(t.where(n,{name:"numberOfDays"})[0]).on("click","[name=suspensionType]",function(t){var n;n=e("[name=numberOfDays]");switch(this.defaultValue){case"limited":return n.show();case"indefinite":return n.hide()}}).on("submit",function(t){var n;return n=e("[name=numberOfDays]")})},_action_field_date:function(t){var n;return t?(n=e('<input type="date" name="'+t.name+'" value="'+t.value+'" />'),this.append(n.hide())):this},_action_field_hidden:function(e){return e?this.append('<input type="hidden" name="'+e.name+'" value="'+e.value+'" />'):this},_action_field_email:function(t){var n;return t?(n=e('<div>\n	You will be notified by email when a copy becomes available\n</div>\n<div>\n	<label>Email address: <input type="email" name="'+t.name+'" value="'+t.value+'" />\n	</label>\n</div>'),Boolean(t.optional)||n.find("input").prop("required",!0),this.append(n)):this},_action_field_radio:function(n){var i,s,o,u,a;return n?(t.remove(n.options,function(e){return e==="ebook-overdrive"}),o=function(){switch(!1){case n.options.length!==1:return"<div>Only one "+n.name+" is available and it has been selected for you</div>";case!Boolean(n.optional):return"<div>You may select a "+n.name+" at this time</div>";default:return"<div>Please select one of the available "+n.name+"s</div>"}}(),u=function(){var t,o,u,f;u=n.options,f=[];for(t=0,o=u.length;t<o;t++)a=u[t],i=e('<div>\n	<input type="radio" name="'+n.name+'" value="'+a+'" />'+r.labels(a)+"\n</div>"),s=i.find("input"),Boolean(n.optional)||s.prop("required",!0),n.options.length>1||s.prop("checked",!0),f.push(i);return f}(),this.append(o).append(u)):this},_action_field_suspend:function(t){var n,r,i,s,o;return t?(s={indefinite:"Suspend this hold indefinitely",limited:"Suspend this hold for a limited time"},i=function(){var i,u,a,f;a=t.options,f=[];for(i=0,u=a.length;i<u;i++)o=a[i],n=e('<div><label>\n	<input type="radio" name="'+t.name+'" value="'+o+'" /> '+s[o]+"\n</label></div>"),r=n.find("input"),Boolean(t.optional)||r.prop("required",!0),o==="indefinite"&&r.prop("checked",!0),f.push(n);return f}(),this.append(i)):this},_formats:function(n,i){var s,o,u,a,f,l,c,h;return n?(c=t.template('<div>\n	<a href="<%= href %>" class="opac-button" style="margin-top: 0px; margin-bottom: 0px"><%= label %></a>\n</div>'),o=this.closest("tr"),s=function(){var t,s,p,d,v;v=[];for(t=0,s=n.length;t<s;t++)a=n[t],l=a.formatType,p=a.linkTemplates,d=p.downloadLink,f=d.href,h=d.type,f=f.replace(/\{errorpageurl\}/,encodeURIComponent(window.location.href)).replace(/\{odreadauthurl\}/,encodeURIComponent(""+window.location.href+"&reserveid=[RESERVE_ID]&read_error=[READ_ERROR]")),u=a.linkTemplates.downloadLink,e.extend(u,{_of:o,_name:l,_id:i,href:f}),v.push(e(c({href:f,label:"Download "+r.labels(l)})).on("click",u,function(t){return t.preventDefault(),e("<div>")._downloadLink(t.data),!1}));return v}(),this.empty().append(s)):this},_notify:function(t,n){return this.dialog({minHeight:0,autoOpen:!0,draggable:!1,resizable:!0,show:{effect:"slideDown"},hide:{effect:"slideUp"},close:function(){return e(this).dialog("destroy")},title:t}).html(n)},_etitle:function(){return this.find(".title a").text()}})});var __slice=[].slice;define("od_pages_myopac",["jquery-noconflict","lodash","od_config","jquery-ui","od_action","od_pages_opac"],function(e,t,n){return e.fn.extend({_counters:function(e){var t,n,r;for(n in e)r=e[n],t=this.find("."+n),t.text(+t.text()+r);return this},_dashboard:function(t){var n;return arguments.length===0?this.append(e('<div id="dashboard">')):(n="/eg/opac/myopac",this.find("div").eq(2).append('<span class="dash-align">\n	<a class="dash-link" href="'+n+'/circs?e_items"><span class="ncheckouts" id="dash_checked">0</span> E-items Checked Out</a>\n</span>\n<span class="dash_divider">|</span>\n<span class="dash-align">\n	<a class="dash-link" href="'+n+'/holds?e_items"><span class="nholds" id="dash_holds">0</span> E-items on Hold</a>\n</span>\n<span class="dash_divider">|</span>\n<span class="dash-align">\n	<a class="dash-link" href="'+n+'/holds?e_items&available=1"><span class="nholdsready" id="dash_pickup">0</span> E-items Ready for Checkout</a>\n</span>').end().end(),this.find("div").css({"float":"none"}).end(),this._counters(t)),this},_account_summary:function(e){var n,r,i;return arguments.length===0?(n=function(){var e,t,n,r;n=this.find("td").not('[align="right"]'),r=[];for(e=0,t=n.length;e<t;e++)i=n[e],r.push(+i.textContent.match(/\d+?/)[0]);return r}.call(this),r=t.template('<tbody>\n	<tr>\n		<td>\n			<a href="/eg/opac/myopac/circs">\n				<span><span class="ncheckouts" /> <%= ncheckouts %> Items Currently Checked out</span>\n			</a>\n		</td>\n		<td align="right">\n			<a href="/eg/opac/myopac/circs?e_items"><span class="n_checkouts" /> E-items Currently Checked out</a>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<a href="/eg/opac/myopac/holds"><span class="nholds" /> <%= nholds %> Items Currently on Hold</a>\n		</td>\n		<td align="right">\n			<a href="/eg/opac/myopac/holds?e_items"><span class="n_holds" /> E-items Currently on Hold</a>\n		</td>\n	</tr>\n	<tr>\n		<td>\n			<a href="/eg/opac/myopac/holds?available=1"><span class="nready" /> <%= nready %> Items ready for pickup</a>\n		</td>\n		<td align="right">\n			<a href="/eg/opac/myopac/holds?e_items&available=1"><span class="n_ready" /> E-items ready for pickup</a>\n		</td>\n	</tr>\n</tbody>'),this.empty().append(r({ncheckouts:n[0],nholds:n[1],nready:n[2]})).find("td").filter('[align="right"]').find("a").hide().end().end()):this._counters(e).find("td").filter('[align="right"]').find("a").show().end().end()},_tab_history:function(){var t;return t=e("a",this),t.text(""+t.text()+" (Physical Items)"),this},_etabs:function(t,n){var r,i;return i={acct_holds_tabs:'<div id="acct_holds_tabs">\n	<div class="align" id=\'tab_holds\'>\n		<a href="holds#">Items on Hold</a>\n	</div>\n	<div class="align" id=\'tab_holds_eitems\'>\n		<a href="holds?e_items">E-items on Hold</a>\n	</div>\n	<div class="align" id=\'tab_holds_history\'>\n		<a href="hold_history">Holds History</a>\n	</div>\n</div>',acct_checked_tabs:'<div id="acct_checked_tabs">\n	<div class="align" id=\'tab_circs\'>\n		<a href="circs#">Current Items Checked Out</a>\n	</div>\n	<div class="align" id=\'tab_circs_eitems\'>\n		<a href="circs?e_items">E-items Checked Out</a>\n	</div>\n	<div class="align" id=\'tab_circs_history\'>\n		<a href="circ_history">Check Out History</a>\n   </div>\n</div>'},this.replaceWith(i[this.prop("id")]),r=/_history$/.test(t)?e("[id$=_history]"):n?e("[id$=_eitems]"):e("[id^=tab_]").not("[id$=_history],[id$=_eitems]"),r.addClass("selected"),this},_resizeCols:function(){var e,t,n,r,i,s,o,u;e=this.find("table").css("width","100%");if(arguments.length>0){n=e.find("th"),t=e.find("td");for(r=o=0,u=arguments.length;o<u;r=++o)s=arguments[r],n.eq(r).css("width",s),t.eq(r).css("width",s)}else i=this.find("th").length||1,s=""+100/i+"%",e.find("th").css("width",s).end().find("td").css("width",s).end();return this},_show_from:function(){var e,t,n,r,i;t=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[];for(r=0,i=e.length;r<i;r++)n=e[r],this.find(n).hide();return this.find(e[t]).show().end()},_replace_title:function(e){return this.find(".header_middle span").eq(0).text(e).end()},_holds_main:function(){var e;return e='<table cellpadding="0" cellspacing="0" border="0">\n	<thead id="acct_holds_main_header"><tr>\n		<th></th>\n		<th>Title/Author</th>\n		<th>Availability</th>\n		<th>Formats</th>\n		<th>Actions</th>\n	</tr></thead>\n	<tbody id="holds_temp_parent"></tbody>\n</table>\n<div class="warning_box">No holds found.</div>',this.empty().append(e)._resizeCols("15%","20%","30%","20%","15%")},_holds_rows:function(n){var r,i,s,o,u;return n?(u=t.template('<tr id="<%= id %>" name="acct_holds_temp" class="acct_holds_temp inactive-hold">\n	<td class="thumbnail"></td>\n	<td>\n		<div class="title" /> by <div class="author" />\n	</td>\n	<td class="availability"></td>\n	<td class="formats"></td>\n	<td class="actions"></td>\n</tr>'),o=[],i=function(){var t,i,a;a=[];for(t=0,i=n.length;t<i;t++)s=n[t],o.push(s.reserveId),r=e(u({id:s.reserveId})),a.push(r._holds_row(s)._row_meta()._holds_row_avail());return a}(),i.length>0&&this.find("tbody").empty().append(i).end().find(".warning_box").remove().end(),o):[]},_holds_row:function(e){var t;return t=e.holdSuspension!=null?1:void 0,this.find("td.availability")._holds_row_avail1(e).end().find("td.actions")._actions(e.actions,e.reserveId,t).end()},_row_meta:function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;o=arguments[0],s=2<=arguments.length?__slice.call(arguments,1):[],a=arguments.length===0?{value:!1}:"destroy";try{p=["title","author","formats"];for(f=0,c=p.length;f<c;f++)u=p[f],this.find("."+u).progressbar(a)}catch(m){}if(!o)return this;i=e('<a href="/eg/opac/results?query='+o.title+';qtype=title">'+o.title+"</a>"),r=e('<img src="'+((d=o.images)!=null?(v=d.thumbnail)!=null?v.href:void 0:void 0)+'" alt="'+o.title+'" />'),t=e('<a href="/eg/opac/results?query='+o.author+';qtype=author">'+o.author+"</a>");for(l=0,h=s.length;l<h;l++){u=s[l],n=this.find("."+u);switch(u){case"thumbnail":n.empty().append(r);break;case"title":n.empty().append(i);break;case"author":n.empty().append(t);break;case"formats":n._show_formats(o!=null?o.formats:void 0)}}return this},_holds_row_avail1:function(e){var r,i,s,o,u;return r=e.holdSuspension?0:e.actions.checkout?1:2,s=((o=e.holdSuspension)!=null?o.suspensionType:void 0)==="limited"?"show":"hide",i=t.template('<div class="suspended">\n	<div style="color: red">Suspended <span class="limited">until <%= activates %></span></div>\n	<ul style="padding-left: 20px">\n	<li name="acct_holds_status"><%= position %> / <%= nHolds %> holds <span class="copies" /></li>\n	<li>Email notification will be sent to <%= email %></li>\n	<li>Hold was placed <%= placed %></li>\n	</ul>\n</div>\n<div class="unavailable">\n	<div>Waiting for copy</div>\n	<ul style="padding-left: 20px">\n	<li name="acct_holds_status"><%= position %> / <%= nHolds %> holds <span class="copies" /></li>\n	<li>Email notification will be sent to <%= email %></li>\n	<li>Hold was placed <%= placed %></li>\n	</ul>\n</div>\n<div class="available">\n	<div style="color: green">Ready for checkout</div>\n	<ul style="padding-left: 20px">\n	<li name="acct_holds_status"><%= position %> / <%= nHolds %> holds <span class="copies" /></li>\n	<li>Hold will expire <%= expires %></li>\n	</ul>\n</div>\n<a href="<%= baseURL %>?ID=<%= id %>">Link to Overdrive Account to change preferences</a>'),this.empty().append(i({position:e.holdListPosition,nHolds:e.numberOfHolds,email:e.emailAddress,expires:e.holdExpires.fromNow(),placed:e.holdPlacedDate.fromNow(),activates:(u=e.holdSuspension)!=null?u.numberOfDays.calendar():void 0,baseURL:n.baseURL,id:e.reserveId}))._show_from(r,".suspended",".available",".unavailable").find(".limited")[s]().end()},_holds_row_avail:function(e){var t,n;return t=arguments.length===0?{value:!1}:"destroy",this.find(".copies").progressbar(t).end(),e?(n="on "+e.copiesOwned+" copies",this.find(".copies").text(n).end()):this},_checkouts_main:function(){var e;return e='<table cellpadding="0" cellspacing="0" border="0">\n	<thead id="acct_checked_main_header"><tr>\n		<th></th>\n		<th>Title/Author</th>\n		<th>Availability</th>\n		<th>Formats</th>\n		<th>Actions</th>\n	</tr></thead>\n	<tbody id="holds_temp_parent"></tbody>\n</table>\n<div class="warning_box">No checkouts found.</div>',this.empty().append(e)._resizeCols()},_checkouts_rows:function(n){var r,i,s,o,u;return n?(u=t.template('<tr id="<%= id %>" name="acct_checked_temp" class="acct_checked_temp inactive-hold">\n	<td class="thumbnail"></td>\n	<td>\n		<div class="title" /> by <div class="author" />\n	</td>\n	<td class="availability"></td>\n	<td class="formats"></td>\n	<td class="actions"></td>\n</tr>'),o=[],i=function(){var t,i,a;a=[];for(t=0,i=n.length;t<i;t++)s=n[t],o.push(s.reserveId),r=e(u({id:s.reserveId})),a.push(r._row_checkout(s)._row_meta());return a}(),i.length>0&&this.find("tbody").empty().append(i).end().find(".warning_box").remove().end(),o):[]},_row_checkout:function(e){return this.find("td.availability")._checkouts_row_avail(e).end().find("td.actions")._actions(e.actions,e.reserveId).end().find("td.formats")._formats(e.formats,e.reserveId).end()},_checkouts_row_avail:function(e){var r;return r=t.template('<div>Expires <%= expires_relatively %></div>\n<div><%= expires_exactly %></div>\n<a href="<%= baseURL %>?ID=<%= id %>">Click to access online (library card required)</a>'),this.empty().append(r({expires_relatively:e.expires.fromNow(),expires_exactly:e.expires.format("YYYY MMM D, h:mm:ss a"),baseURL:n.baseURL,id:e.reserveId}))},_holdings_row:function(n){var r,i;return i=t.template('<tr id="<%= id %>" name="acct_holds_temp" class="acct_holds_temp inactive-hold">\n	<td class="thumbnail"></td>\n	<td>\n		<div class="title" /> by <div class="author" />\n	</td>\n	<td class="availability"></td>\n	<td class="formats"><ul></ul></td>\n	<td class="actions"></td>\n</tr>'),r=e(i({id:n}))._row_meta()._holdings_row_avail(),this.find("tbody").empty().append(r).end().find(".warning_box").remove().end()},_holdings_row_avail:function(e){var n,r;return n=arguments.length===0?{value:!1}:"destroy",this.find("td.availability").progressbar(n).end().find("td.actions").progressbar(n).end(),e?(r=t.template('<div class="unavailable">No copies are available for checkout</div>\n<div class="available" style="color: green">A copy is available for checkout</div>\n<div><%= n_avail %> of <%= n_owned %> available, <%= n_holds %> holds</div>'),this.find("td.availability").append(r({n_owned:e.copiesOwned,n_avail:e.copiesAvailable,n_holds:e.numberOfHolds})).end().find("td.actions")._actions(e.actions,e.id).end()._show_from(e.available?0:1,".available",".unavailable")):this}})});var __hasProp={}.hasOwnProperty;require(["jquery-noconflict","lodash","cookies","od_api","od_config","od_pages_opac","od_pages_myopac","od_action"],function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p;u=!1,o=function(){return console.log(window.location.pathname)},a=function(e){return console.log(""+e+" is in progress")},s=function(e){return console.log(""+e+" failed")},l=function(){return window.location.reload(!0)},c=function(e){return window.location.replace(e)},p=function(e){var n,r,i,s,o,u;return n=(i=(s=decodeURIComponent(window.location.search))!=null?(o=s.split("?"))!=null?(u=o[1])!=null?u.split(/&|;/):void 0:void 0:void 0)?t.zipObject(function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++)r=i[e],n.push(r.replace(/\+/g," ").split("="));return n}()):{},arguments.length===1?n[e]||n.hasOwnProperty(e):n},f=function(){var e;return e=window.location.pathname.match(/eg\/opac\/(.+)/),e?e[1].replace(/\/\d+/,""):""},h={handle:function(e){var t,n,r;e==null&&(e=window.location.pathname),r=[];for(t in this){if(!__hasProp.call(this,t))continue;n=this[t],t!=="handle"&&((new RegExp(t)).test(e)?r.push(n()):r.push(void 0))}return r},"eg/opac":function(){var t;return t=e("#dash_wrapper")._dashboard(),r.$.on({"od.interests":function(e,n){return t._dashboard({ncheckouts:n.nCheckouts,nholds:n.nHolds,nholdsready:n.nHoldsReady})},"od.hold.delete":function(){return t._dashboard({nholds:-1})},"od.checkout.delete":function(){return t._dashboard({ncheckouts:-1})},"od.logout":function(e,t){if(t==="od"&&u)return window.location.replace("/eg/opac/logout")}})},"opac/myopac":function(t){t==null&&(t=f()),e("#acct_holds_tabs, #acct_checked_tabs")._etabs(t,p("e_items")),e("#tab_holds_history, #tab_circs_history")._tab_history()},"opac/home":function(){if(!u)return r.$.triggerHandler("od.logout","eg")},"opac/login":function(){return e("form","#login-form-box").one("submit",function(){return r.login({username:e("[name=username]").val(),password:e("[name=password]").val()})})},"myopac/main":function(t){t==null&&(t=e(".acct_sum_table"));if(!t.length)return;return t._account_summary(),r.$.on("od.interests",function(e,n){return t._account_summary({n_checkouts:n.nCheckouts,n_holds:n.nHolds,n_ready:n.nHoldsReady})})},"myopac/prefs":function(){var t,n,i,s;return t=e("#myopac_summary_tbody > tr"),i=t.eq(6).find("td").eq(1).text(),n=t.eq(7).find("td").eq(1).text(),s=t.eq(8).find("td").eq(1).text(),r.$.triggerHandler("od.prefs",{email_address:i,barcode:n,home_library:s})},"opac/results":function(t){var n,s,o,a,f,l;t==null&&(t={}),n=[],l=i.productbaseURLs;for(a=0,f=l.length;a<f;a++)o=l[a],n.push('a[href*="'+o+'"]');s=e(n.join(",")).closest(".result_table_row")._results();if((s!=null?s.length:void 0)===0)return;return r.$.on({"od.interests":function(e,n){var i,o,a;for(o=0,a=s.length;o<a;o++)i=s[o],r.apiAvailability({id:i}),u||r.apiMetadata({id:i});return t=n.byID},"od.metadata":function(t,n){return e("#"+n.id)._results_meta(n)},"od.availability":function(n,i){var s;e("#"+i.id)._results_avail(i)._replace_place_hold_link(i,(s=t[i.id])!=null?s.type:void 0);if(u)return i.available?e("#"+i.id)._results_meta(i):r.apiMetadata({id:i.id})}})},"opac/record":function(t){var n;t==null&&(t={});if(!(n=e("div.rdetail_uris")._record()))return;return r.$.on({"od.interests":function(e,i){return u||r.apiMetadata({id:n}),r.apiAvailability({id:n}),t=i.byID},"od.metadata":function(t,n){return e("#"+n.id)._record_meta(n)},"od.availability":function(n,i){var s;e("#"+i.id)._record_avail(i),e("#rdetail_actions_div")._replace_place_hold_link(i,(s=t[i.id])!=null?s.type:void 0);if(u)return i.available?e("#"+i.id)._record_meta(i):r.apiMetadata({id:i.id})}})},"opac/place_hold":function(t,n){var i;n==null&&(n={});if(!t)return;return e("#myopac_holds_div")._replace_title("Place E-Item on Hold"),e("#myopac_checked_div")._replace_title("Check out E-Item"),e("#holds_main, #checked_main, .warning_box").remove(),i=e('<div id="#holds_main">')._holds_main()._holdings_row(t).appendTo(e("#myopac_holds_div, #myopac_checked_div")),r.$.on({"od.interests":function(i,s){return n=s.byID,e.when(r.apiMetadata({id:t}),r.apiAvailability({id:t})).then(function(t,r){var i;return((i=n[r.id])!=null?i.type:void 0)?window.history.go(-2):(e("#"+t.id)._row_meta(t,"thumbnail","title","author"),e("#"+t.id)._row_meta(r.available?r:t,"formats"),e("#"+r.id)._holdings_row_avail(r).find(".opac-button.hold, .opac-button.checkout").focus().end())})}})},"myopac/holds":function(){var n,i,s;if(s=p("interested"))return h["opac/place_hold"](s);if(!p("e_items")){e(".warning_box").text(e(".warning_box").text().replace(" holds"," physical holds"));return}if(!(i=e("#myopac_holds_div")).length)return;return i._replace_title("Current E-Items on Hold"),e("#holds_main, .warning_box").remove(),n=e('<div id="#holds_main">')._holds_main().appendTo(i),r.$.on({"od.interests":function(e,i){var o,u,a,f,l;o=i!=null?i.ofHolds:void 0,p("available")&&(o=t.filter(o,function(e){return e.actions.checkout})),u=n._holds_rows(o),l=[];for(a=0,f=u.length;a<f;a++)s=u[a],r.apiMetadata({id:s}),l.push(r.apiAvailability({id:s}));return l},"od.metadata":function(t,n){return e("#"+n.id)._row_meta(n,"thumbnail","title","author","formats")},"od.availability":function(t,n){return e("#"+n.id)._holds_row_avail(n)},"od.hold.update":function(t,n){return n=n.holds[0],e("#"+n.reserveId)._holds_row(n)},"od.hold.delete":function(t,n){return e("#"+n).remove()}})},"myopac/circs":function(){var t,n,i,s;if(s=p("interested"))return h["opac/place_hold"](s);(i=p("read_error"))?e("<div>")._notify("Error message","<p>Could not get content</p>\n<div>Error code: "+i+"</div>\n<div>Reserve ID: "+p("reserveid")+"</div>"):(i=p("ErrorCode"))&&e("<div>")._notify("Error message","<p>"+p("ErrorDescription")+"</p>\n<div>Error code: "+i+"</div>\n<div>Details: "+p("ErrorDetails")+"</div>");if(!p("e_items")){e(".warning_box").text(e(".warning_box").text().replace(" items"," physical items"));return}if(!(t=e("#myopac_checked_div")).length)return;return t._replace_title("Current E-Items Checked Out"),e("#checked_main, .warning_box").remove(),n=e('<div id="#checked_main">')._checkouts_main().appendTo(t),r.$.on({"od.interests":function(e,t){var i,o,u,a;i=n._checkouts_rows(t!=null?t.ofCheckouts:void 0),a=[];for(o=0,u=i.length;o<u;o++)s=i[o],a.push(r.apiMetadata({id:s}));return a},"od.metadata":function(t,n){return e("#"+n.id)._row_meta(n,"thumbnail","title","author")},"od.checkout.update":function(t,n){return n=n.checkouts[0],e("#"+n.reserveId)._row_checkout(n)},"od.checkout.delete":function(t,n){return e("#"+n).remove()}})}},e(function(){if(window.IAMXUL)return;if(i.blacklisted())return;u=Boolean(n("eg_loggedin")||window.IAMXUL);if(t.every(h.handle(),function(e){return e===void 0}))return;r.apiLibraryInfo().then(function(){var e;return u?r.login().then(r.apiInterestsGet):(e={byID:{}},r.$.triggerHandler("od.interests",e),e)})})}),define("overdrive",function(){});